---
name: figma-design-rule-extractor
description: |
  Figma MCP를 활용하여 디자인 토큰을 추출하고 디자인 규칙을 생성/동기화합니다.
  Figma 디자인 토큰 추출, 디자인 시스템 규칙화, 디자인 규칙 동기화,
  design-rule.md 업데이트, 컬러/타이포/스페이싱 토큰 추출 시 사용하세요.
license: MIT
metadata:
  author: hanssem
  version: "2.0.0"
  category: design-system
allowed-tools: Bash Read Write Edit
---

# Figma Design Rule Extractor

Figma MCP의 `create_design_system_rules` 도구를 활용하여 디자인 규칙을 추출하고 `./.ai/docs/design-rule.md`로 관리합니다.

## 핵심 원칙

| 원칙 | 설명 |
|------|------|
| **MCP First** | `create_design_system_rules` 도구로 직접 규칙 생성 |
| **Single Source of Truth** | `./.ai/docs/design-rule.md`가 디자인 규칙의 원본 |
| **Fail Fast** | MCP 실패 시 즉시 사용자에게 설정 안내 |

---

## 실행 단계

### Step 1: 사용자 정보 수집

**반드시 사용자에게 질문할 항목:**

1. **Figma 파일 정보**
   - Figma URL 또는 File Key
   - (선택) 특정 Node ID

2. **clientLanguages** (필수)
   - 프로젝트에서 사용하는 언어 목록
   - 예: `javascript`, `typescript`, `html`, `css`

3. **clientFrameworks** (필수)
   - 프로젝트에서 사용하는 프레임워크 목록
   - 예: `react`, `vue`, `nextjs`, `tailwind`
   - 모르면 `unknown`

### Step 2: MCP 호출

```
MCP Tool: create_design_system_rules

Parameters:
- fileKey: Figma 파일 키 (URL에서 추출)
- nodeId: 특정 노드 ID (선택, 기본값: 루트)
- clientLanguages: 사용자 입력값
- clientFrameworks: 사용자 입력값
```

### Step 3: 결과 처리

**성공 시:**
1. MCP 응답을 `./.ai/docs/design-rule.md`에 저장
2. 기존 파일이 있으면 병합 (Changelog 추가)
3. (선택) `.claude/rules/design-system/`에 동기화

**실패 시:**
→ [MCP 설정 안내](#mcp-설정-안내) 참조

---

## MCP 호출 예시

```typescript
// Figma URL에서 fileKey 추출
// https://www.figma.com/file/ABC123DEF/Design-System
//                           ^^^^^^^^^ fileKey

await mcp.create_design_system_rules({
  fileKey: "ABC123DEF",
  nodeId: "0:1",  // 선택
  clientLanguages: "typescript, css",
  clientFrameworks: "react, tailwind"
});
```

---

## MCP 설정 안내

MCP 호출 실패 시 사용자에게 안내:

```
Figma MCP가 설정되지 않았습니다.

다음 단계를 따라 설정해주세요:

1. Figma Personal Access Token 생성
   - Figma > Settings > Personal access tokens
   - 새 토큰 생성 (read 권한)

2. MCP 설정 추가
   ~/.claude/mcp_settings.json 또는 프로젝트 .mcp.json에:

   {
     "mcpServers": {
       "figma": {
         "command": "npx",
         "args": ["-y", "@anthropic/figma-mcp"],
         "env": {
           "FIGMA_ACCESS_TOKEN": "your-token-here"
         }
       }
     }
   }

3. Claude Code 재시작

설정 완료 후 다시 시도해주세요.
```

---

## 문서 저장 경로

### 기본 경로
```
./.ai/docs/design-rule.md
```

### 문서 구조

```markdown
---
title: Design System Rules
source: Figma
figma_file: {fileKey}
last_sync: {ISO timestamp}
---

# Design System Rules

> Figma에서 추출된 디자인 규칙
> Generated by: create_design_system_rules

{MCP 응답 내용}

## Changelog

### {date}
- Initial extraction / Updated from Figma
```

---

## Rule 동기화 (선택)

사용자가 `--sync-rules` 요청 시:

1. `./.ai/docs/design-rule.md` 내용을 기반으로
2. `.claude/rules/design-system/RULE.md` 생성/업데이트
3. 상세 내용은 [references/step-4-sync.md](references/step-4-sync.md) 참조

---

## 사용 예시

```bash
# 기본 사용
/figma-design-rule-extractor

# Figma URL 직접 전달
/figma-design-rule-extractor https://www.figma.com/file/ABC123/Design-System

# Rule 동기화 포함
/figma-design-rule-extractor --sync-rules
```

---

## 실행 흐름 요약

```
┌─────────────────────────────────────────────────────────────┐
│ 1. 사용자 정보 수집                                          │
│    └─ Figma URL, clientLanguages, clientFrameworks 질문     │
├─────────────────────────────────────────────────────────────┤
│ 2. MCP 호출: create_design_system_rules                     │
│    └─ 실패 시 → MCP 설정 안내 후 종료                        │
├─────────────────────────────────────────────────────────────┤
│ 3. 결과 저장: ./.ai/docs/design-rule.md                      │
│    └─ 기존 파일 있으면 병합                                  │
├─────────────────────────────────────────────────────────────┤
│ 4. (선택) Rule 동기화: .claude/rules/design-system/         │
└─────────────────────────────────────────────────────────────┘
```

---

## 체크리스트

실행 후 확인:
```
□ design-rule.md 생성/업데이트됨
□ 타임스탬프 갱신됨
□ (선택) .claude/rules/ 동기화됨
```

---

## 참조

- [Step 4: Rule 동기화 상세](references/step-4-sync.md)
